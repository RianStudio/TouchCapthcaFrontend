<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>demo</title>
    <script type="text/javascript" src="http://code.jquery.com/jquery-2.1.4.min.js"></script>
    <script src="//code.jquery.com/ui/1.11.4/jquery-ui.js"></script>
    <script type="text/javascript" src="assets/func.js"></script>
    <style type="text/css">
        .box_1{
            position:relative;
            height: 200px;
            width: 260px;
            background-color: antiquewhite;

        }
        .box_2{
            height: 30px;
            width: 260px;
            background-color: aquamarine;
        }

        .but{
            height: 30px;
            width: 40px;

            /*margin-top: 5px;*/
            /*background-color: black;*/
            /*background-color: aquamarine;*/
            position: absolute;
        }

        .but-drag{
            background-color: beige;
        }


        .hidden{
            display: none;

        }

        .pic-k{
            width: 240px;
            height: 180px;
            position: absolute;
            left: 10px;
            top: 10px;
            overflow: hidden;

        }




        .div-a{ position:absolute;  background:#F00;  z-index: 10}
        /* css注释说明： 背景为红色 */
        .div-b{ position:absolute;  background:#FF0;  z-index: 20}
        /* 背景为黄色 */
        .div-c{ position:absolute;   z-index: 30}
        /* DIV背景颜色为蓝色 */

    </style>
</head>
<body>

<h1>captchca demo</h1>

<form action="#" method="post">


    <label for="email"  >email</label><input type="email" name="email" id="email"><br/>

    <label for="password"  >password</label><input type="password" name="password" id="password"><br/>



    <div class="captchca_box ">

        <div class="box_1" >
            <!--放置一个图片-->
            <div id="div-a" class="div-a pic-k">图片载入中</div>
            <div id="div-b" class="div-b pic-k"> </div>
            <div id="div-c" class="div-c pic-k">
                <div class="but" id="but-u"><img src="" id="drag_img"></div>
                <!--<img src="" id="" class="but" >-->
            </div>


        </div>
        <div class="box_2">
            拖拽拼图到指定位置以验证 <button onclick="init()" type="button">重新载入图片</button>

        </div>

    </div><br/>

    <button type="submit" value="submit" >Commit</button>

</form>



<script>

    function  init(){
        $(function () {
            showC()

            //图片展示区域为240 180
            //240/6= 40  180/6=30


            //初始化图片
            var pic="http://img5.duitang.com/uploads/item/201406/12/20140612192936_FtNy4.thumb.700_0.jpeg";
            //初始化裁剪位置
            var width_l=200;
            var height_l=150;
            var but_width_p=Math.ceil( Math.random() * width_l) ;
            var but_height_p=Math.ceil( Math.random() * height_l);
            var clip_right=width_l-but_width_p;
            var clip_down=height_l-but_height_p;

            var rect_str="rect("+but_width_p+"px, "+clip_right+"px, "+clip_down+"px, "+ but_height_p+ "px)";

//            console.log(rect_str);
            //进行按钮的裁剪
            $("#drag_img").attr("src",pic);
            $("#div-c").css('background',"url('"+pic+"')");
            $("#drag_img").css("position",'absolute');
            $("#drag_img").css("clip",rect_str);

//            $(".")

            //初始化碎片所在位置

            $('#but-u').css('top',but_height_p);
            $('#but-u').css('left',but_width_p);

            //

            $("#but-u").draggable(
                    {
                        containment: "parent",

                        create: function (event, ui) {

                            showC()

                        }, drag: function (event, ui) {
                        // Keep the left edge of the element
                        // at least 100 pixels from the container
                        ui.position.left = Math.min(250, ui.position.left);

//                        $("#drag").addClass('but-drag');
                        showC();
                        console.log('left:'+ui.position.left+'  top:'+ui.position.top);

                    }, stop: function (event, ui) {

//                        $("#drag").removeClass('but-drag')

                        showC()
                        if (ui.position.left > 150) {
                            showB()
                        }
                    }

                    }
            );


        });
    }

    init()

    function showA(){
//        $( "#div-a" ).addClass('hidden');
        $( "#div-b" ).addClass('hidden');
        $( "#div-c" ).addClass('hidden');
        $( "#div-a" ).removeClass('hidden');
//        $( "#div-b" ).removeClass('hidden');
//        $( "#div-c" ).removeClass('hidden');
    }
    function showB(){
        $( "#div-a" ).addClass('hidden');
//        $( "#div-b" ).addClass('hidden');
        $( "#div-c" ).addClass('hidden');
//        $( "#div-a" ).removeClass('hidden');
        $( "#div-b" ).removeClass('hidden');
//        $( "#div-c" ).removeClass('hidden');
    }
    function showC(){
        $( "#div-a" ).addClass('hidden');
        $( "#div-b" ).addClass('hidden');
//        $( "#div-c" ).addClass('hidden');
//        $( "#div-a" ).removeClass('hidden');
//        $( "#div-b" ).removeClass('hidden');
        $( "#div-c" ).removeClass('hidden');
    }
    loading()
</script>
</body>
</html>